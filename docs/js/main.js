let jobs=[],url="",numPage=1;const MAX_CARDS_PAGE=50,form=document.querySelector(".js-form"),termsInputField=document.querySelector(".js-terms"),divCardsList=document.querySelector(".js-cards-list"),toggleSwitch=document.querySelector('.switch input[type="checkbox"]'),modal=document.querySelector(".js-modal"),btnOpenModal=document.querySelector(".js-btn-modal"),btnModalSearch=document.querySelector(".js-modal-submit-btn"),switchTheme=e=>{e.target.checked?document.documentElement.setAttribute("data-theme","dark"):document.documentElement.setAttribute("data-theme","ligth")},showModal=e=>{e.preventDefault(),modal.classList.remove("hidden")},hideModal=()=>{modal.classList.add("hidden")},setURL=(e,t,a)=>(url=`https://cors-anywhere.herokuapp.com/https://jobs.github.com/positions.json?page=${numPage}`,void 0===e&&void 0===t||(""!==e&&(url+=`&description=${e}`),""!==t&&(url+=`&location=${t}`),a&&(url+="&full_time=on")),url),showMessage=e=>{divCardsList.innerHTML="";const t=document.createElement("p"),a=document.createTextNode(e);t.classList.add("message"),divCardsList.appendChild(t),t.appendChild(a)},getJobs=async(e,t,a)=>{url=setURL(e,t,a);try{const e=await fetch(url);return jobs=await e.json(),jobs}catch(e){showMessage("Lo sentimos, ha ocurrido un error en el servidor. Prueba más tarde")}},showLoadMoreBtn=()=>{const e=document.createElement("button");e.className="btn-primary js-loadMoreBtn";const t=document.createTextNode("Load more");e.appendChild(t),e.addEventListener("click",handleLoad),divCardsList.after(e)},calculateTime=e=>{const t=new Date(e),a=new Date-t,o=Math.floor(a/36e5);if(o<24)return`${o}h`;const n=Math.floor(a/864e5);if(n<7)return`${n}d`;const d=Math.floor(a/6048e5);if(d<4)return`${d}w`;return`${Math.floor(a/2592e6)}m`},renderCards=()=>{1===numPage&&(divCardsList.innerHTML="");let e="";jobs.forEach(((t,a)=>{const o=`\n      <div class = "card js-card${a>49?" hidden":""}">\n        <div class="card-icon" style="background-image: url(${t.company_logo})"></div>\n        <div class="card-content">\n          <p class="text-secondary">${calculateTime(t.created_at)} ago · ${t.type}</p>\n          <h3><a href=#>${t.title}</a></h3>\n          <p class="text-secondary">${t.company}</p>\n        </div>\n        <h4 class="card-footer primary-color">${t.location}</h4>\n      </div>\n      `;e+=o})),divCardsList.insertAdjacentHTML("beforeend",e);const t=document.querySelector(".js-loadMoreBtn");50===jobs.length?(numPage++,!t&&showLoadMoreBtn()):jobs.length<50&&t&&t.remove()},handleLoad=async()=>{jobs=await getJobs(),renderCards()},handleSearch=async e=>{e.preventDefault();const t=form.elements.terms.value,a=form.elements.location.value,o=form.elements.jobType.checked;jobs=await getJobs(t,a,o),renderCards()},handleModalSearch=async e=>{e.preventDefault(),hideModal();const t=document.querySelector(".js-modal-location"),a=document.querySelector(".js-modal-fullTime"),o=termsInputField.value,n=t.value,d=a.checked;jobs=await getJobs(o,n,d),renderCards()},mediaQuery=window.matchMedia("(max-width: 850px)"),changePlaceholderText=e=>{const t=document.querySelector(".js-label");e.matches?(termsInputField.placeholder="Filter by title...",t.innerHTML="Full Time"):(termsInputField.placeholder="Filter by title, companies, expertise...",t.innerHTML="Full Time Only")};changePlaceholderText(mediaQuery),mediaQuery.addListener(changePlaceholderText),btnOpenModal.addEventListener("click",showModal),document.addEventListener("DOMContentLoaded",handleLoad),form.addEventListener("submit",handleSearch),toggleSwitch.addEventListener("change",switchTheme),btnModalSearch.addEventListener("click",handleModalSearch),window.addEventListener("click",(e=>{e.target===modal&&hideModal()}));