let jobs=[],url="",numPage=1;const MAX_CARDS_PAGE=50,form=document.querySelector(".js-form"),divCardsList=document.querySelector(".js-cards-list"),toggleSwitch=document.querySelector('.switch input[type="checkbox"]'),switchTheme=e=>{e.target.checked?document.documentElement.setAttribute("data-theme","dark"):document.documentElement.setAttribute("data-theme","ligth")},setURL=(e,t,a)=>(url=`https://cors-anywhere.herokuapp.com/https://jobs.github.com/positions.json?page=${numPage}`,void 0===e&&void 0===t||(""!==e&&(url+=`&description=${e}`),""!==t&&(url+=`&location=${t}`),a&&(url+="&full_time=on")),url),showMessage=e=>{divCardsList.innerHTML="";const t=document.createElement("p"),a=document.createTextNode(e);t.classList.add("message"),divCardsList.appendChild(t),t.appendChild(a)},showLoadMoreBtn=()=>{const e=document.createElement("button");e.className="btn-primary js-loadMoreBtn";const t=document.createTextNode("Load more");e.appendChild(t),e.addEventListener("click",handleLoad),divCardsList.after(e)},getJobs=async(e,t,a)=>{url=setURL(e,t,a),console.log(url);try{const e=await fetch(url);return jobs=await e.json(),jobs}catch(e){showMessage("Lo sentimos, ha ocurrido un error en el servidor. Prueba más tarde")}},renderCards=()=>{1===numPage&&(divCardsList.innerHTML="");let e="";jobs.forEach(((t,a)=>{const n=`\n      <div class = "card js-card${a>49?" hidden":""}">\n        <div class="card-icon" style="background-image: url(${t.company_logo})"></div>\n        <div class="card-content">\n          <p class="text-secondary">${calculateTime(t.created_at)} ago · ${t.type}</p>\n          <h3><a href=#>${t.title}</a></h3>\n          <p class="text-secondary">${t.company}</p>\n        </div>\n        <h4 class="card-footer primary-color">${t.location}</h4>\n      </div>\n      `;e+=n})),divCardsList.insertAdjacentHTML("beforeend",e);const t=document.querySelector(".js-loadMoreBtn");50===jobs.length?(numPage++,!t&&showLoadMoreBtn()):jobs.length<50&&t&&t.remove()},handleSearch=async e=>{e.preventDefault();const t=form.elements.terms.value,a=form.elements.location.value,n=form.elements.jobType.checked;numPage=1,jobs=await getJobs(t,a,n),renderCards()},handleLoad=async()=>{jobs=await getJobs(),renderCards()},calculateTime=e=>{const t=new Date(e),a=new Date-t,n=Math.floor(a/36e5);if(n<24)return`${n}h`;const o=Math.floor(a/864e5);if(o<7)return`${o}d`;const r=Math.floor(a/6048e5);if(r<4)return`${r}w`;return`${Math.floor(a/2592e6)}m`},mediaQuery=window.matchMedia("(max-width: 850px)"),termsInputField=document.querySelector(".js-terms"),changePlaceholderText=e=>{const t=document.querySelector(".js-label");e.matches?(termsInputField.placeholder="Filter by title...",t.innerHTML="Full Time"):(termsInputField.placeholder="Filter by title, companies, expertise...",t.innerHTML="Full Time Only")},mediaQueryMobile=window.matchMedia("(max-width: 640px)"),changeSearchBox=e=>{const t=document.querySelector(".js-submit-btn");e.matches?t.innerHTML='\n      <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg">\n        <path d="M17.112 15.059h-1.088l-.377-.377a8.814 8.814 0 002.15-5.784A8.898 8.898 0 008.898 0 8.898 8.898 0 000 8.898a8.898 8.898 0 008.898 8.899c2.211 0 4.23-.808 5.784-2.143l.377.377v1.081l6.845 6.832 2.04-2.04-6.832-6.845zm-8.214 0A6.16 6.16 0 118.9 2.737a6.16 6.16 0 010 12.322z" fill="#fff" fill-rule="nonzero"/>\n      </svg>\n      ':t.innerHTML="Search"};changePlaceholderText(mediaQuery),mediaQuery.addListener(changePlaceholderText),changeSearchBox(mediaQueryMobile),mediaQueryMobile.addListener(changeSearchBox),document.addEventListener("DOMContentLoaded",handleLoad),form.addEventListener("submit",handleSearch),toggleSwitch.addEventListener("change",switchTheme);