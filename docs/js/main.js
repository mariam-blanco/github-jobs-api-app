let url="",numPage=1;const MAX_CARDS_PAGE=50,termsInputField=document.querySelector(".js-terms"),divCardsList=document.querySelector(".js-cards-list"),toggleSwitch=document.querySelector('.switch input[type="checkbox"]'),switchTheme=e=>{e.target.checked?document.documentElement.setAttribute("data-theme","dark"):document.documentElement.setAttribute("data-theme","ligth")};toggleSwitch.addEventListener("change",switchTheme);const modal=document.querySelector(".js-modal"),btnOpenModal=document.querySelector(".js-btn-modal"),showModal=e=>{e.preventDefault(),modal.classList.remove("hidden")},hideModal=()=>{modal.classList.add("hidden")};btnOpenModal.addEventListener("click",showModal),window.addEventListener("click",(e=>{e.target===modal&&hideModal()}));const setURL=(e,t,a)=>(url=`https://cors-anywhere.herokuapp.com/https://jobs.github.com/positions.json?page=${numPage}`,void 0===e&&void 0===t||(""!==e&&(url+=`&description=${e}`),""!==t&&(url+=`&location=${t}`),a&&(url+="&full_time=on")),url),showMessage=e=>{divCardsList.innerHTML="";const t=document.createElement("p");t.classList.add("message"),divCardsList.appendChild(t),t.innerHTML=e},getJobs=async(e,t,a)=>{let o=[];url=setURL(e,t,a);try{const e=await fetch(url);if(403===e.status)throw new Error('\n        failed to load resource. \n        <ol>\n          <li>Go to <a href="https://cors-anywhere.herokuapp.com/corsdemo">cors-anywhere.herokuapp.com</a></li>\n          <li>Click the button to unlock CORS Anywhere for your browser</li>\n          <li>Come back to this page and reload to get the jobs list.</li>\n        </ol> \n        ');o=await e.json(),renderCards(o)}catch(e){showMessage(e)}},showLoadMoreBtn=()=>{const e=document.createElement("button");e.className="btn-primary js-loadMoreBtn";const t=document.createTextNode("Load more");e.appendChild(t),e.addEventListener("click",handleLoad),divCardsList.after(e)},calculateTime=e=>{const t=new Date(e),a=new Date-t,o=Math.floor(a/36e5);if(o<24)return`${o}h`;const n=Math.floor(a/864e5);if(n<7)return`${n}d`;const r=Math.floor(a/6048e5);if(r<4)return`${r}w`;return`${Math.floor(a/2592e6)}m`},renderCards=e=>{1===numPage&&(divCardsList.innerHTML="");let t="";e.forEach(((e,a)=>{const o=`\n      <div class = "card js-card${a>49?" hidden":""}">\n        <div class="card-icon" style="background-image: url(${e.company_logo})"></div>\n        <div class="card-content">\n          <p class="text-secondary">${calculateTime(e.created_at)} ago Â· ${e.type}</p>\n          <h3><a href=#>${e.title}</a></h3>\n          <p class="text-secondary">${e.company}</p>\n        </div>\n        <h4 class="card-footer primary-color">${e.location}</h4>\n      </div>\n      `;t+=o})),divCardsList.insertAdjacentHTML("beforeend",t);const a=document.querySelector(".js-loadMoreBtn");50===e.length?(numPage++,!a&&showLoadMoreBtn()):e.length<50&&a&&a.remove()},handleLoad=async()=>{getJobs()};document.addEventListener("DOMContentLoaded",handleLoad);const form=document.querySelector(".js-form"),btnSmallSearch=document.querySelector(".js-small-search-btn"),btnModalSearch=document.querySelector(".js-modal-search-btn"),handleSearch=async e=>{e.preventDefault();let t="",a="",o="";numPage=1;const n=document.querySelector(".js-modal-location"),r=document.querySelector(".js-modal-fullTime");e.target===form?(t=form.elements.terms.value,a=form.elements.location.value,o=form.elements.jobType.checked):e.target===btnSmallSearch?t=termsInputField.value:e.target===btnModalSearch&&(hideModal(),t=termsInputField.value,a=n.value,o=r.checked),getJobs(t,a,o),e.target===form?(form.elements.terms.value="",form.elements.location.value="",form.elements.jobType.checked=!1):e.target===btnSmallSearch?termsInputField.value="":e.target===btnModalSearch&&(termsInputField.value="",n.value="",r.checked=!1)};form.addEventListener("submit",handleSearch),btnModalSearch.addEventListener("click",handleSearch),btnSmallSearch.addEventListener("click",handleSearch);const mediaQuery=window.matchMedia("(max-width: 850px)"),changePlaceholderText=e=>{const t=document.querySelector(".js-label");e.matches?(termsInputField.placeholder="Filter by title...",t.innerHTML="Full Time"):(termsInputField.placeholder="Filter by title, companies, expertise...",t.innerHTML="Full Time Only")};changePlaceholderText(mediaQuery),mediaQuery.addListener(changePlaceholderText);