let url="",numPage=1;const MAX_CARDS_PAGE=50,termsInputField=document.querySelector(".js-terms"),divCardsList=document.querySelector(".js-cards-list"),toggleSwitch=document.querySelector('.switch input[type="checkbox"]'),switchTheme=e=>{e.target.checked?document.documentElement.setAttribute("data-theme","dark"):document.documentElement.setAttribute("data-theme","ligth")};toggleSwitch.addEventListener("change",switchTheme);const modal=document.querySelector(".js-modal"),btnOpenModal=document.querySelector(".js-btn-modal"),showModal=e=>{e.preventDefault(),modal.classList.remove("hidden")},hideModal=()=>{modal.classList.add("hidden")};btnOpenModal.addEventListener("click",showModal),window.addEventListener("click",(e=>{e.target===modal&&hideModal()}));const setURL=(e,t,a)=>(url=`https://cors-anywhere.herokuapp.com/https://jobs.github.com/positions.json?page=${numPage}`,void 0===e&&void 0===t||(""!==e&&(url+=`&description=${e}`),""!==t&&(url+=`&location=${t}`),a&&(url+="&full_time=on")),url),showMessage=e=>{divCardsList.innerHTML="";const t=document.createElement("p"),a=document.createTextNode(e);t.classList.add("message"),divCardsList.appendChild(t),t.appendChild(a)},getJobs=async(e,t,a)=>{let n=[];url=setURL(e,t,a);try{const e=await fetch(url);n=await e.json(),renderCards(n)}catch(e){showMessage("Lo sentimos, ha ocurrido un error en el servidor. Prueba más tarde")}},showLoadMoreBtn=()=>{const e=document.createElement("button");e.className="btn-primary js-loadMoreBtn";const t=document.createTextNode("Load more");e.appendChild(t),e.addEventListener("click",handleLoad),divCardsList.after(e)},calculateTime=e=>{const t=new Date(e),a=new Date-t,n=Math.floor(a/36e5);if(n<24)return`${n}h`;const o=Math.floor(a/864e5);if(o<7)return`${o}d`;const r=Math.floor(a/6048e5);if(r<4)return`${r}w`;return`${Math.floor(a/2592e6)}m`},renderCards=e=>{1===numPage&&(divCardsList.innerHTML="");let t="";e.forEach(((e,a)=>{const n=`\n      <div class = "card js-card${a>49?" hidden":""}">\n        <div class="card-icon" style="background-image: url(${e.company_logo})"></div>\n        <div class="card-content">\n          <p class="text-secondary">${calculateTime(e.created_at)} ago · ${e.type}</p>\n          <h3><a href=#>${e.title}</a></h3>\n          <p class="text-secondary">${e.company}</p>\n        </div>\n        <h4 class="card-footer primary-color">${e.location}</h4>\n      </div>\n      `;t+=n})),divCardsList.insertAdjacentHTML("beforeend",t);const a=document.querySelector(".js-loadMoreBtn");50===e.length?(numPage++,!a&&showLoadMoreBtn()):e.length<50&&a&&a.remove()},handleLoad=async()=>{getJobs()};document.addEventListener("DOMContentLoaded",handleLoad);const form=document.querySelector(".js-form"),btnSmallSearch=document.querySelector(".js-small-search-btn"),btnModalSearch=document.querySelector(".js-modal-search-btn"),handleSearch=async e=>{e.preventDefault();let t="",a="",n="";numPage=1;const o=document.querySelector(".js-modal-location"),r=document.querySelector(".js-modal-fullTime");e.target===form?(t=form.elements.terms.value,a=form.elements.location.value,n=form.elements.jobType.checked):e.target===btnSmallSearch?t=termsInputField.value:e.target===btnModalSearch&&(hideModal(),t=termsInputField.value,a=o.value,n=r.checked),getJobs(t,a,n),e.target===form?(form.elements.terms.value="",form.elements.location.value="",form.elements.jobType.checked=!1):e.target===btnSmallSearch?termsInputField.value="":e.target===btnModalSearch&&(termsInputField.value="",o.value="",r.checked=!1)};form.addEventListener("submit",handleSearch),btnModalSearch.addEventListener("click",handleSearch),btnSmallSearch.addEventListener("click",handleSearch);const mediaQuery=window.matchMedia("(max-width: 850px)"),changePlaceholderText=e=>{const t=document.querySelector(".js-label");e.matches?(termsInputField.placeholder="Filter by title...",t.innerHTML="Full Time"):(termsInputField.placeholder="Filter by title, companies, expertise...",t.innerHTML="Full Time Only")};changePlaceholderText(mediaQuery),mediaQuery.addListener(changePlaceholderText);